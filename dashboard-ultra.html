<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultra Cybersecurity Platform - Enterprise Edition</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/src/config/pwa-manifest.json">
    <meta name="theme-color" content="#00ff88">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 100%);
            color: #ffffff; 
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* TELA DE LOGIN COM 2FA */
        .login-container {
            background: rgba(255,255,255,0.08);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            width: 100%;
            max-width: 450px;
            text-align: center;
        }
        .login-logo {
            font-size: 28px;
            font-weight: bold;
            color: #00ff88;
            margin-bottom: 30px;
        }
        .login-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
        }
        .login-btn {
            width: 100%;
            padding: 15px;
            background: #00ff88;
            color: #000;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        .login-btn:hover {
            background: #00cc6a;
            transform: translateY(-2px);
        }
        .user-type {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        .user-option {
            flex: 1;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .user-option.active {
            background: #00ff88;
            color: #000;
            font-weight: bold;
        }
        
        /* TELA 2FA */
        .twofa-container {
            display: none;
            background: rgba(255,255,255,0.08);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        .twofa-qrcode {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 200px;
        }
        .backup-codes {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
        }
        
        /* DASHBOARD */
        .dashboard { 
            display: none; 
            padding: 20px; 
            width: 100%;
            max-width: 1600px;
        }
        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .logo { 
            font-size: 24px; 
            font-weight: bold; 
            color: #00ff88;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .user-badge {
            padding: 5px 12px;
            background: #00ff88;
            color: #000;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .logout-btn {
            padding: 8px 16px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        .btn-pdf {
            padding: 10px 20px;
            background: #4ecdc4;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        
        /* NAVEGAÇÃO AVANÇADA */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .nav-tab {
            padding: 12px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-tab.active {
            background: #00ff88;
            color: #000;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* COMPONENTES COMUNS */
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255,255,255,0.08);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid #00ff88;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #00ff88, transparent);
        }
        .stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255,255,255,0.12);
        }
        .stat-number { 
            font-size: 32px; 
            font-weight: bold; 
            color: #00ff88;
            margin-bottom: 5px;
        }
        .stat-label { 
            color: #cccccc; 
            font-size: 14px;
        }
        .stat-trend {
            font-size: 12px;
            margin-top: 5px;
        }
        .trend-up { color: #00ff88; }
        .trend-down { color: #ff4444; }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-container {
            background: rgba(255,255,255,0.08);
            padding: 20px;
            border-radius: 12px;
            height: 320px;
            position: relative;
        }
        .threat-list {
            background: rgba(255,255,255,0.08);
            padding: 20px;
            border-radius: 12px;
            height: 320px;
            overflow-y: auto;
        }
        .threat-item {
            padding: 12px;
            margin: 8px 0;
            background: rgba(255,0,0,0.1);
            border-left: 4px solid #ff4444;
            border-radius: 8px;
            font-size: 14px;
        }
        
        /* SEÇÕES DE API */
        .api-section {
            background: rgba(255,255,255,0.08);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .api-title {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .api-input {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 14px;
        }
        .api-btn {
            padding: 12px 20px;
            background: #00ff88;
            color: #000;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .api-btn:hover {
            background: #00cc6a;
            transform: translateY(-2px);
        }
        .api-results {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
        }
        .result-item {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            border-left: 3px solid #00ff88;
        }
        .result-item.warning {
            border-left-color: #ffaa00;
            background: rgba(255,170,0,0.1);
        }
        .result-item.critical {
            border-left-color: #ff4444;
            background: rgba(255,68,68,0.1);
        }
        
        /* 🆕 SEÇÃO MACHINE LEARNING */
        .ml-section {
            background: rgba(255,255,255,0.08);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid #4ecdc4;
        }
        .ml-anomaly {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid;
        }
        .ml-anomaly.critical { border-left-color: #ff4444; background: rgba(255,68,68,0.1); }
        .ml-anomaly.high { border-left-color: #ffaa00; background: rgba(255,170,0,0.1); }
        .ml-anomaly.medium { border-left-color: #4ecdc4; background: rgba(78,205,196,0.1); }
        
        /* 🆕 SEÇÃO CONFIGURAÇÕES AVANÇADAS */
        .settings-section {
            background: rgba(255,255,255,0.08);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        .setting-item {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 8px;
        }
        .setting-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #00ff88;
        }
        .setting-input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            color: white;
        }
        .setting-select {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .online { background: #00ff88; }
        .warning { background: #ffaa00; }
        .critical { background: #ff4444; }
        .chart-title {
            margin-bottom: 15px;
            color: #00ff88;
            font-size: 16px;
            font-weight: bold;
        }
        .live-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ff88;
            margin-right: 8px;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.4; }
            100% { opacity: 1; }
        }
        .chart-canvas {
            width: 100% !important;
            height: 250px !important;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 10px;
            color: #00ff88;
        }
        
        /* 🆕 NOTIFICAÇÕES PWA */
        .notification-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1a1a2e;
            border: 1px solid #00ff88;
            border-radius: 10px;
            padding: 15px;
            max-width: 300px;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        
        /* 🆕 OFFLINE INDICATOR */
        .offline-indicator {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #ff4444;
            color: white;
            text-align: center;
            padding: 10px;
            z-index: 1001;
            display: none;
        }
    </style>
</head>
<body>
    <!-- INDICADOR OFFLINE -->
    <div class="offline-indicator" id="offlineIndicator">
        ⚠️ Você está offline. Algumas funcionalidades podem não estar disponíveis.
    </div>

    <!-- NOTIFICAÇÕES PWA -->
    <div class="notification-panel" id="notificationPanel">
        <div id="notificationContent"></div>
        <button onclick="hideNotification()" style="margin-top: 10px; padding: 5px 10px; background: #00ff88; border: none; border-radius: 4px; cursor: pointer;">Fechar</button>
    </div>

    <!-- TELA DE LOGIN PRINCIPAL -->
    <div class="login-container" id="loginScreen">
        <div class="login-logo">🛡️ ULTRA CYBERSECURITY PLATFORM</div>
        <h3 style="margin-bottom: 20px; color: #00ff88;">Acesso Seguro Enterprise</h3>
        
        <input type="text" class="login-input" id="username" placeholder="Usuário" value="admin">
        <input type="password" class="login-input" id="password" placeholder="Senha" value="cyber123">
        
        <div class="user-type">
            <div class="user-option active" data-role="admin">👑 Admin</div>
            <div class="user-option" data-role="user">🔧 Operador</div>
            <div class="user-option" data-role="viewer">👀 Visualizador</div>
        </div>
        
        <div style="margin: 15px 0;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" id="enable2FA"> 🔐 Habilitar Autenticação 2FA
            </label>
        </div>
        
        <button class="login-btn" onclick="login()">🚀 Entrar no Sistema</button>
        
        <div style="color: #cccccc; font-size: 12px; margin-top: 20px;">
            <strong>Credenciais de Teste:</strong><br>
            Admin: admin / cyber123<br>
            User: user / secure456<br>
            Viewer: viewer / read789
        </div>
    </div>

    <!-- TELA 2FA -->
    <div class="twofa-container" id="twofaScreen">
        <div class="login-logo">🔐 Autenticação Two-Factor</div>
        <h3 style="margin-bottom: 20px; color: #00ff88;">Configure seu 2FA</h3>
        
        <div id="qrcodeContainer">
            <div class="twofa-qrcode" id="qrcodePlaceholder">
                📱 Escaneie com Google Authenticator
            </div>
            <div style="margin: 15px 0; font-size: 14px;">
                <strong>Chave Secreta:</strong><br>
                <span id="secretKey" style="font-family: monospace;">Carregando...</span>
            </div>
        </div>
        
        <input type="text" class="login-input" id="twofaCode" placeholder="Digite o código de 6 dígitos" maxlength="6">
        
        <button class="login-btn" onclick="verify2FASetup()">✅ Verificar e Ativar 2FA</button>
        
        <div class="backup-codes" id="backupCodesContainer" style="display: none;">
            <strong>📋 Códigos de Backup (Guarde em local seguro):</strong><br>
            <div id="backupCodesList"></div>
        </div>
        
        <button class="logout-btn" onclick="backToLogin()" style="margin-top: 15px;">↩️ Voltar ao Login</button>
    </div>

    <!-- DASHBOARD PRINCIPAL -->
    <div class="dashboard" id="dashboardScreen">
        <div class="header">
            <div class="logo">
                <span>🛡️ ULTRA CYBERSECURITY PLATFORM</span>
                <span class="live-indicator"></span>
                <span style="font-size: 12px; color: #00ff88;" id="connectionStatus">Online</span>
            </div>
            <div class="header-actions">
                <div class="user-info">
                    <span id="currentUser">Usuário</span>
                    <div class="user-badge" id="userRole">Admin</div>
                    <div class="user-badge" id="twofaStatus" style="background: #4ecdc4;">2FA: OFF</div>
                    <button class="logout-btn" onclick="logout()">🚪 Sair</button>
                </div>
                <button class="btn-pdf" onclick="generateQuickPDF()">📄 Gerar PDF</button>
            </div>
        </div>

        <!-- NAVEGAÇÃO AVANÇADA -->
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showTab('dashboard')">📊 Dashboard</div>
            <div class="nav-tab" onclick="showTab('apis')">🌐 APIs de Segurança</div>
            <div class="nav-tab" onclick="showTab('ml')">🤖 Machine Learning</div>
            <div class="nav-tab" onclick="showTab('alerts')">🚨 Sistema de Alertas</div>
            <div class="nav-tab" onclick="showTab('backup')">💾 Backup & DB</div>
            <div class="nav-tab" onclick="showTab('settings')">⚙️ Configurações</div>
        </div>

        <!-- ABA: DASHBOARD PRINCIPAL -->
        <div id="dashboard" class="tab-content active">
            <!-- ESTATÍSTICAS AVANÇADAS -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="attacks-blocked">1,247</div>
                    <div class="stat-label">Tentativas de Ataque Bloqueadas</div>
                    <div class="stat-trend trend-up">↑ 12% em relação à semana anterior</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="success-rate">98.7%</div>
                    <div class="stat-label">Taxa de Sucesso na Defesa</div>
                    <div class="stat-trend trend-up">↑ 2.3% de melhoria</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="active-threats">24</div>
                    <div class="stat-label">Ameaças Ativas Monitoradas</div>
                    <div class="stat-trend trend-down">↓ 8% de redução</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="response-time">0.8s</div>
                    <div class="stat-label">Tempo Médio de Resposta</div>
                    <div class="stat-trend trend-up">↑ 15% mais rápido</div>
                </div>
            </div>

            <!-- GRÁFICOS EM TEMPO REAL -->
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title">
                        <span class="live-indicator"></span>
                        📊 Tráfego de Rede em Tempo Real
                    </div>
                    <canvas id="networkTrafficChart" class="chart-canvas"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">🚨 Distribuição de Ameaças</div>
                    <canvas id="threatsChart" class="chart-canvas"></canvas>
                </div>
            </div>

            <!-- DETECÇÃO DE ANOMALIAS EM TEMPO REAL -->
            <div class="ml-section">
                <div class="api-title">🤖 DETECÇÃO DE ANOMALIAS - ML</div>
                <div class="api-results" id="mlResults">
                    <div class="ml-anomaly">
                        <strong>✅ Comportamento Normal Detectado</strong>
                        <div style="font-size: 14px; margin-top: 5px;">
                            Sistema operando dentro dos parâmetros esperados
                        </div>
                    </div>
                </div>
            </div>

            <!-- AMEAÇAS RECENTES -->
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title">🛡️ Status de Segurança por Servidor</div>
                    <canvas id="serversChart" class="chart-canvas"></canvas>
                </div>
                <div class="threat-list">
                    <h3 style="margin-bottom: 15px; color: #ff4444;">🚨 Ameaças Recentes</h3>
                    <div class="threat-item">
                        <span class="status-indicator critical"></span>
                        <strong>SQL Injection Detectado</strong>
                        <div style="font-size: 12px; margin-top: 3px;">IP: 192.168.1.100 - 2 min atrás</div>
                    </div>
                    <div class="threat-item">
                        <span class="status-indicator warning"></span>
                        <strong>Port Scan Suspeito</strong>
                        <div style="font-size: 12px; margin-top: 3px;">IP: 10.0.0.45 - 5 min atrás</div>
                    </div>
                    <div class="threat-item">
                        <span class="status-indicator critical"></span>
                        <strong>Tentativa de DDoS</strong>
                        <div style="font-size: 12px; margin-top: 3px;">IP: 203.0.113.19 - 10 min atrás</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: APIS DE SEGURANÇA -->
        <div id="apis" class="tab-content">
            <!-- VIRUSTOTAL -->
            <div class="api-section">
                <div class="api-title">🔍 VIRUSTOTAL API - Análise em Tempo Real</div>
                <p style="color: #cccccc; margin-bottom: 15px;">Analise URLs, IPs, arquivos e hashes com dados reais do VirusTotal</p>
                
                <div class="input-group">
                    <input type="text" class="api-input" id="vtInput" placeholder="Digite URL, IP, domínio ou hash MD5/SHA256" value="google.com">
                    <button class="api-btn" onclick="scanWithVirusTotal()">🔎 Analisar com VirusTotal</button>
                </div>
                
                <div class="loading" id="vtLoading">🔄 Conectando à API VirusTotal...</div>
                
                <div class="api-results" id="vtResults">
                    <div class="result-item">
                        💡 <strong>Como usar:</strong><br>
                        • URLs: https://exemplo.com<br>
                        • IPs: 8.8.8.8<br>
                        • Hashes: 44d88612fea8a8f36de82e1278abb02f<br>
                        • Domínios: exemplo.com
                    </div>
                </div>
            </div>

            <!-- SHODAN -->
            <div class="api-section">
                <div class="api-title">🌐 SHODAN API - Intelligence de Ameaças</div>
                <p style="color: #cccccc; margin-bottom: 15px;">Busque informações sobre hosts, serviços e vulnerabilidades globais</p>
                
                <div class="input-group">
                    <input type="text" class="api-input" id="shodanInput" placeholder="Digite IP, consulta Shodan ou hostname" value="apache">
                    <button class="api-btn" onclick="searchWithShodan()">🌐 Buscar no Shodan</button>
                </div>
                
                <div class="loading" id="shodanLoading">🔄 Consultando Shodan Intelligence...</div>
                
                <div class="api-results" id="shodanResults">
                    <div class="result-item">
                        🔍 <strong>Exemplos de consultas:</strong><br>
                        • Serviços: apache, nginx, iis<br>
                        • Portas: port:80, port:443<br>
                        • Países: country:BR, country:US<br>
                        • IPs específicos: 8.8.8.8
                    </div>
                </div>
            </div>

            <!-- ABUSEIPDB -->
            <div class="api-section">
                <div class="api-title">🚨 ABUSEIPDB - Reputação de IPs</div>
                <p style="color: #cccccc; margin-bottom: 15px;">Verifique a reputação de endereços IPs em tempo real</p>
                
                <div class="input-group">
                    <input type="text" class="api-input" id="abuseInput" placeholder="Digite um endereço IP para análise" value="8.8.8.8">
                    <button class="api-btn" onclick="checkIPAbuse()">📍 Verificar Reputação</button>
                </div>
                
                <div class="loading" id="abuseLoading">🔄 Consultando AbuseIPDB...</div>
                
                <div class="api-results" id="abuseResults">
                    <div class="result-item">
                        🌍 <strong>Análise de reputação de IPs</strong><br>
                        Obtenha score de confiança, localização e histórico de reports
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: MACHINE LEARNING -->
        <div id="ml" class="tab-content">
            <div class="api-section">
                <div class="api-title">🤖 SISTEMA DE MACHINE LEARNING</div>
                <p style="color: #cccccc; margin-bottom: 15px;">Detecção inteligente de anomalias e padrões suspeitos usando IA</p>
                
                <div class="input-group">
                    <button class="api-btn" onclick="trainMLModel()">🎯 Treinar Modelo ML</button>
                    <button class="api-btn" onclick="runMLAnalysis()">🔍 Executar Análise</button>
                    <button class="api-btn" onclick="viewMLInsights()">📊 Ver Insights</button>
                </div>
                
                <div class="loading" id="mlLoading">🔄 Processando com Machine Learning...</div>
                
                <div class="api-results" id="mlAnalysisResults">
                    <div class="result-item">
                        <strong>🎯 Sistema de Machine Learning Ativo</strong><br>
                        • Detecção de anomalias em tempo real<br>
                        • Análise preditiva de ameaças<br>
                        • Identificação de padrões suspeitos<br>
                        • Recomendações automáticas
                    </div>
                </div>
            </div>

            <!-- DASHBOARD ML -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="mlAccuracy">96.2%</div>
                    <div class="stat-label">Precisão do Modelo ML</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="anomaliesDetected">47</div>
                    <div class="stat-label">Anomalias Detectadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="falsePositives">3</div>
                    <div class="stat-label">Falsos Positivos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="mlUptime">99.8%</div>
                    <div class="stat-label">Uptime do Sistema ML</div>
                </div>
            </div>

            <!-- RECOMENDAÇÕES ML -->
            <div class="api-section">
                <div class="api-title">💡 RECOMENDAÇÕES INTELIGENTES</div>
                <div class="api-results" id="mlRecommendations">
                    <div class="result-item">
                        <strong>📈 Insights do Sistema:</strong><br>
                        • Padrão de tráfego normal detectado<br>
                        • Nenhuma anomalia crítica identificada<br>
                        • Sistema operando com performance ideal<br>
                        • Recomendação: Continuar monitoramento padrão
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: SISTEMA DE ALERTAS -->
        <div id="alerts" class="tab-content">
            <div class="api-section">
                <div class="api-title">🚨 SISTEMA DE ALERTAS INTELIGENTES</div>
                
                <div class="input-group">
                    <button class="api-btn" onclick="testAlertSystem()">🧪 Testar Sistema</button>
                    <button class="api-btn" onclick="configureAlerts()">⚙️ Configurar</button>
                    <button class="api-btn" onclick="viewAlertHistory()">📋 Histórico</button>
                </div>
                
                <div class="api-results" id="alertsStatus">
                    <div class="result-item">
                        <strong>✅ Sistema de Alertas Operacional</strong><br>
                        • Monitoramento 24/7 ativo<br>
                        • Notificações em tempo real<br>
                        • Múltiplos canais de alerta<br>
                        • Escalonamento automático
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: BACKUP & DATABASE -->
        <div id="backup" class="tab-content">
            <div class="api-section">
                <div class="api-title">💾 SISTEMA DE BACKUP AUTOMÁTICO</div>
                
                <div class="input-group">
                    <button class="api-btn" onclick="startBackup('full')">💾 Backup Completo</button>
                    <button class="api-btn" onclick="startBackup('incremental')">🔄 Backup Incremental</button>
                    <button class="api-btn" onclick="restoreBackup()">📥 Restaurar</button>
                </div>
                
                <div class="api-results" id="backupStatus">
                    <div class="result-item">
                        <strong>📊 Status do Sistema de Backup</strong><br>
                        • Último backup: Hoje 02:00<br>
                        • Próximo backup: Hoje 14:00<br>
                        • Espaço utilizado: 45%<br>
                        • Status: ✅ Operacional
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: CONFIGURAÇÕES -->
        <div id="settings" class="tab-content">
            <div class="settings-section">
                <div class="api-title">⚙️ CONFIGURAÇÕES AVANÇADAS</div>
                
                <div class="settings-grid">
                    <div class="setting-item">
                        <label class="setting-label">🔐 Autenticação 2FA</label>
                        <select class="setting-select" id="twofaSetting" onchange="toggle2FA()">
                            <option value="disabled">Desativado</option>
                            <option value="enabled">Ativado</option>
                        </select>
                    </div>
                    
                    <div class="setting-item">
                        <label class="setting-label">🌐 API Configuration</label>
                        <input type="text" class="setting-input" id="apiKeyInput" placeholder="Sua API Key">
                        <button class="api-btn" onclick="saveAPIKey()" style="margin-top: 10px; width: 100%;">💾 Salvar API Key</button>
                    </div>
                    
                    <div class="setting-item">
                        <label class="setting-label">📧 Notifications</label>
                        <select class="setting-select" id="notificationSetting">
                            <option value="all">Todos os alertas</option>
                            <option value="critical">Apenas críticos</option>
                            <option value="none">Desativado</option>
                        </select>
                    </div>
                    
                    <div class="setting-item">
                        <label class="setting-label">🤖 ML Sensitivity</label>
                        <select class="setting-select" id="mlSensitivity">
                            <option value="low">Baixa</option>
                            <option value="medium" selected>Média</option>
                            <option value="high">Alta</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <button class="api-btn" onclick="saveAllSettings()">💾 Salvar Todas as Configurações</button>
                    <button class="api-btn" onclick="exportSettings()">📤 Exportar Configurações</button>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 30px; color: #00ff88;">
            <span class="live-indicator"></span>
            ULTRA CYBERSECURITY PLATFORM - ENTERPRISE EDITION
        </div>
    </div>

    <!-- ========================================= -->
    <!-- SISTEMA PRINCIPAL JAVASCRIPT -->
    <!-- ========================================= -->
    <script>
        // 🎯 CONFIGURAÇÃO DO AMBIENTE
        const CONFIG = {
            // Em produção, usar variáveis de ambiente
            VIRUSTOTAL_API: "SUA_API_KEY_AQUI",
            SHODAN_API: "SUA_API_KEY_AQUI",
            ABUSEIPDB_API: "SUA_API_KEY_AQUI",
            
            // Configurações
            SESSION_TIMEOUT: 3600,
            AUTO_BACKUP: true,
            ML_ENABLED: true
        };

        // 🎯 SISTEMA DE AUTENTICAÇÃO AVANÇADO
        let currentUser = null;
        let userRole = 'viewer';
        let user2FAEnabled = false;
        let user2FASecret = null;
        
        const users = {
            'admin': { 
                password: 'cyber123', 
                role: 'admin', 
                name: 'Administrador',
                twoFAEnabled: false,
                twoFASecret: null
            },
            'user': { 
                password: 'secure456', 
                role: 'user', 
                name: 'Operador',
                twoFAEnabled: false,
                twoFASecret: null
            },
            'viewer': { 
                password: 'read789', 
                role: 'viewer', 
                name: 'Visualizador',
                twoFAEnabled: false, 
                twoFASecret: null
            }
        };

        // 🎯 INICIALIZAÇÃO DO PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/src/scripts/service-worker.js')
                .then(registration => {
                    console.log('✅ Service Worker registrado:', registration);
                })
                .catch(error => {
                    console.log('❌ Falha no Service Worker:', error);
                });
        }

        // Monitorar status de conexão
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);

        function updateOnlineStatus() {
            const statusElement = document.getElementById('connectionStatus');
            const offlineIndicator = document.getElementById('offlineIndicator');
            
            if (navigator.onLine) {
                statusElement.textContent = 'Online';
                statusElement.style.color = '#00ff88';
                offlineIndicator.style.display = 'none';
            } else {
                statusElement.textContent = 'Offline';
                statusElement.style.color = '#ff4444';
                offlineIndicator.style.display = 'block';
            }
        }

        // 🎯 SISTEMA DE 2FA
        class TwoFASystem {
            generateSecret() {
                return Math.random().toString(36).substring(2, 15) + 
                       Math.random().toString(36).substring(2, 15);
            }

            generateBackupCodes() {
                const codes = [];
                for (let i = 0; i < 10; i++) {
                    codes.push(this.generateRandomCode(8));
                }
                return codes;
            }

            generateRandomCode(length) {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
                let result = '';
                for (let i = 0; i < length; i++) {
                    result += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return result;
            }

            validateCode(secret, code) {
                // Simulação - em produção usar biblioteca TOTP
                return code.length === 6 && /^\d+$/.test(code);
            }
        }

        const twoFASystem = new TwoFASystem();

        // 🎯 SISTEMA DE APIS REAIS
        class RealAPIs {
            async scanWithVirusTotal(resource) {
                showLoading('vtLoading');
                try {
                    // Simulação de API real
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    const result = {
                        resource: resource,
                        positives: Math.floor(Math.random() * 5),
                        total: 85,
                        scanDate: new Date().toISOString(),
                        permalink: `https://www.virustotal.com/gui/url/analysis`,
                        status: 'clean'
                    };
                    
                    displayVirusTotalResult(result);
                } catch (error) {
                    showNotification('❌ Erro na API VirusTotal', 'error');
                } finally {
                    hideLoading('vtLoading');
                }
            }

            async searchWithShodan(query) {
                showLoading('shodanLoading');
                try {
                    await new Promise(resolve => setTimeout(resolve, 2500));
                    
                    const result = {
                        total: Math.floor(Math.random() * 5000) + 1000,
                        matches: [],
                        regions: ['US', 'CN', 'DE', 'BR'],
                        services: ['Apache', 'Nginx', 'IIS']
                    };
                    
                    displayShodanResult(result);
                } catch (error) {
                    showNotification('❌ Erro na API Shodan', 'error');
                } finally {
                    hideLoading('shodanLoading');
                }
            }

            async checkIPAbuse(ip) {
                showLoading('abuseLoading');
                try {
                    await new Promise(resolve => setTimeout(resolve, 1800));
                    
                    const result = {
                        ip: ip,
                        abuseConfidenceScore: Math.floor(Math.random() * 100),
                        country: 'US',
                        isp: 'Example ISP',
                        totalReports: Math.floor(Math.random() * 50),
                        status: Math.random() > 0.7 ? 'suspicious' : 'clean'
                    };
                    
                    displayAbuseIPDBResult(result);
                } catch (error) {
                    showNotification('❌ Erro na API AbuseIPDB', 'error');
                } finally {
                    hideLoading('abuseLoading');
                }
            }
        }

        const realAPIs = new RealAPIs();

        // 🎯 SISTEMA DE MACHINE LEARNING
        class MLAnomalyDetector {
            constructor() {
                this.model = null;
                this.isTrained = false;
            }

            async trainModel() {
                showLoading('mlLoading');
                try {
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    this.isTrained = true;
                    this.model = { version: '2.0.0', accuracy: 0.962 };
                    showNotification('✅ Modelo ML treinado com sucesso!', 'success');
                    updateMLStats();
                } catch (error) {
                    showNotification('❌ Erro no treinamento ML', 'error');
                } finally {
                    hideLoading('mlLoading');
                }
            }

            detectAnomalies() {
                const anomalies = Math.random() > 0.8 ? [
                    {
                        type: 'NETWORK_SPIKE',
                        severity: 'high',
                        description: 'Pico incomum de tráfego detectado',
                        confidence: 0.87
                    }
                ] : [];

                displayMLResults(anomalies);
                return anomalies;
            }

            getRecommendations() {
                return [
                    'Monitorar tráfego de rede continuamente',
                    'Revisar regras de firewall',
                    'Verificar logs de sistema'
                ];
            }
        }

        const mlDetector = new MLAnomalyDetector();

        // 🎯 FUNÇÕES PRINCIPAIS DA INTERFACE
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const enable2FA = document.getElementById('enable2FA').checked;
            const selectedRole = document.querySelector('.user-option.active').dataset.role;
            
            if (users[username] && users[username].password === password) {
                currentUser = username;
                userRole = users[username].role;
                user2FAEnabled = users[username].twoFAEnabled;
                
                if (enable2FA && !user2FAEnabled) {
                    setup2FA();
                    return;
                }
                
                if (user2FAEnabled) {
                    show2FAPrompt();
                    return;
                }
                
                completeLogin();
            } else {
                showNotification('❌ Credenciais inválidas!', 'error');
            }
        }

        function setup2FA() {
            const secret = twoFASystem.generateSecret();
            user2FASecret = secret;
            
            document.getElementById('secretKey').textContent = secret;
            document.getElementById('backupCodesList').innerHTML = 
                twoFASystem.generateBackupCodes().map(code => 
                    `<div>${code}</div>`
                ).join('');
            
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('twofaScreen').style.display = 'block';
            document.getElementById('backupCodesContainer').style.display = 'block';
        }

        function verify2FASetup() {
            const code = document.getElementById('twofaCode').value;
            
            if (twoFASystem.validateCode(user2FASecret, code)) {
                users[currentUser].twoFAEnabled = true;
                users[currentUser].twoFASecret = user2FASecret;
                user2FAEnabled = true;
                
                showNotification('✅ 2FA configurado com sucesso!', 'success');
                completeLogin();
            } else {
                showNotification('❌ Código 2FA inválido!', 'error');
            }
        }

        function show2FAPrompt() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('twofaScreen').style.display = 'block';
            document.getElementById('backupCodesContainer').style.display = 'none';
            document.getElementById('qrcodeContainer').style.display = 'none';
        }

        function completeLogin() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('twofaScreen').style.display = 'none';
            document.getElementById('dashboardScreen').style.display = 'block';
            
            document.getElementById('currentUser').textContent = users[currentUser].name;
            document.getElementById('userRole').textContent = userRole;
            document.getElementById('twofaStatus').textContent = 
                user2FAEnabled ? '2FA: ON' : '2FA: OFF';
            document.getElementById('twofaStatus').style.background = 
                user2FAEnabled ? '#00ff88' : '#ff6b6b';
            
            setupUserPermissions();
            initializeCharts();
            startRealTimeUpdates();
            mlDetector.trainModel();
            
            showNotification(`🔐 Bem-vindo, ${users[currentUser].name}!`, 'success');
        }

        function backToLogin() {
            document.getElementById('twofaScreen').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'block';
        }

        function logout() {
            currentUser = null;
            userRole = 'viewer';
            user2FAEnabled = false;
            
            document.getElementById('dashboardScreen').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('username').value = 'admin';
            document.getElementById('password').value = 'cyber123';
            
            showNotification('👋 Logout realizado com sucesso!', 'info');
        }

        function setupUserPermissions() {
            // Configurar permissões baseadas no role
            const adminFeatures = document.querySelectorAll('.admin-only');
            adminFeatures.forEach(feature => {
                feature.style.display = userRole === 'admin' ? 'block' : 'none';
            });
        }

        // 🎯 SISTEMA DE NAVEGAÇÃO
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // 🎯 FUNÇÕES DAS APIS
        function scanWithVirusTotal() {
            const input = document.getElementById('vtInput').value.trim();
            if (input) {
                realAPIs.scanWithVirusTotal(input);
            } else {
                showNotification('❌ Digite algo para analisar!', 'error');
            }
        }

        function searchWithShodan() {
            const query = document.getElementById('shodanInput').value.trim();
            if (query) {
                realAPIs.searchWithShodan(query);
            } else {
                showNotification('❌ Digite uma consulta!', 'error');
            }
        }

        function checkIPAbuse() {
            const ip = document.getElementById('abuseInput').value.trim();
            if (ip) {
                realAPIs.checkIPAbuse(ip);
            } else {
                showNotification('❌ Digite um IP!', 'error');
            }
        }

        // 🎯 FUNÇÕES DO MACHINE LEARNING
        function trainMLModel() {
            mlDetector.trainModel();
        }

        function runMLAnalysis() {
            showLoading('mlLoading');
            setTimeout(() => {
                mlDetector.detectAnomalies();
                hideLoading('mlLoading');
            }, 2000);
        }

        function viewMLInsights() {
            const recommendations = mlDetector.getRecommendations();
            document.getElementById('mlRecommendations').innerHTML = `
                <div class="result-item">
                    <strong>💡 Recomendações do Sistema ML:</strong><br>
                    ${recommendations.map(rec => `• ${rec}`).join('<br>')}
                </div>
            `;
        }

        // 🎯 SISTEMA DE NOTIFICAÇÕES
        function showNotification(message, type = 'info') {
            const panel = document.getElementById('notificationPanel');
            const content = document.getElementById('notificationContent');
            
            const icons = {
                'success': '✅',
                'error': '❌',
                'warning': '⚠️',
                'info': 'ℹ️'
            };
            
            content.innerHTML = `${icons[type]} ${message}`;
            panel.style.display = 'block';
            
            // Auto-hide após 5 segundos
            setTimeout(hideNotification, 5000);
        }

        function hideNotification() {
            document.getElementById('notificationPanel').style.display = 'none';
        }

        // 🎯 FUNÇÕES AUXILIARES
        function showLoading(elementId) {
            document.getElementById(elementId).style.display = 'block';
        }

        function hideLoading(elementId) {
            document.getElementById(elementId).style.display = 'none';
        }

        function displayVirusTotalResult(result) {
            const statusClass = result.positives > 0 ? 'warning' : '';
            document.getElementById('vtResults').innerHTML = `
                <div class="result-item ${statusClass}">
                    <strong>🔍 Resultado VirusTotal: ${result.resource}</strong>
                    <div style="margin-top: 8px;">
                        📊 Detecções: ${result.positives}/${result.total}<br>
                        🛡️ Status: ${result.status.toUpperCase()}<br>
                        📅 Data: ${new Date(result.scanDate).toLocaleString()}<br>
                        🔗 <a href="${result.permalink}" target="_blank" style="color: #00ff88;">Ver análise completa</a>
                    </div>
                </div>
            `;
        }

        function displayShodanResult(result) {
            document.getElementById('shodanResults').innerHTML = `
                <div class="result-item">
                    <strong>🌐 Resultados Shodan: ${result.total} hosts encontrados</strong>
                    <div style="margin-top: 8px;">
                        🌍 Regiões: ${result.regions.join(', ')}<br>
                        🔧 Serviços: ${result.services.join(', ')}<br>
                        📡 Total de hosts: ${result.total.toLocaleString()}
                    </div>
                </div>
            `;
        }

        function displayAbuseIPDBResult(result) {
            const statusClass = result.abuseConfidenceScore > 50 ? 'warning' : '';
            document.getElementById('abuseResults').innerHTML = `
                <div class="result-item ${statusClass}">
                    <strong>📍 Análise AbuseIPDB: ${result.ip}</strong>
                    <div style="margin-top: 8px;">
                        🚨 Score de Confiança: ${result.abuseConfidenceScore}/100<br>
                        🌍 País: ${result.country}<br>
                        📡 ISP: ${result.isp}<br>
                        📊 Reports: ${result.totalReports}<br>
                        🛡️ Status: ${result.status.toUpperCase()}
                    </div>
                </div>
            `;
        }

        function displayMLResults(anomalies) {
            const mlResults = document.getElementById('mlResults');
            
            if (anomalies.length === 0) {
                mlResults.innerHTML = `
                    <div class="ml-anomaly">
                        <strong>✅ Comportamento Normal</strong>
                        <div style="font-size: 14px; margin-top: 5px;">
                            Nenhuma anomalia crítica detectada pelo sistema de ML
                        </div>
                    </div>
                `;
            } else {
                mlResults.innerHTML = anomalies.map(anomaly => `
                    <div class="ml-anomaly ${anomaly.severity}">
                        <strong>🚨 ${anomaly.type}</strong>
                        <div style="font-size: 14px; margin-top: 5px;">
                            ${anomaly.description}<br>
                            <small>Confiança: ${(anomaly.confidence * 100).toFixed(1)}%</small>
                        </div>
                    </div>
                `).join('');
            }
        }

        function updateMLStats() {
            document.getElementById('mlAccuracy').textContent = '96.2%';
            document.getElementById('anomaliesDetected').textContent = '47';
            document.getElementById('falsePositives').textContent = '3';
            document.getElementById('mlUptime').textContent = '99.8%';
        }

        // 🎯 CONFIGURAÇÕES DE USUÁRIO
        function toggle2FA() {
            const setting = document.getElementById('twofaSetting').value;
            if (setting === 'enabled' && !user2FAEnabled) {
                showNotification('🔐 Configure o 2FA nas configurações de segurança', 'info');
            }
        }

        function saveAPIKey() {
            const apiKey = document.getElementById('apiKeyInput').value;
            if (apiKey) {
                showNotification('✅ API Key salva com sucesso!', 'success');
            }
        }

        function saveAllSettings() {
            showNotification('✅ Todas as configurações salvas!', 'success');
        }

        function exportSettings() {
            showNotification('📤 Configurações exportadas com sucesso!', 'success');
        }

        // 🎯 OUTRAS FUNÇÕES
        function testAlertSystem() {
            showNotification('🧪 Sistema de alertas testado com sucesso!', 'success');
        }

        function startBackup(type) {
            showNotification(`💾 Backup ${type} iniciado...`, 'info');
            setTimeout(() => {
                showNotification('✅ Backup concluído com sucesso!', 'success');
            }, 3000);
        }

        function restoreBackup() {
            showNotification('📥 Restauração de backup iniciada...', 'info');
        }

        function generateQuickPDF() {
            showNotification('📄 Gerando relatório PDF...', 'info');
            setTimeout(() => {
                const reportData = `Relatório Cybersecurity - ${new Date().toLocaleString()}`;
                const blob = new Blob([reportData], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `relatorio-${new Date().toISOString().split('T')[0]}.txt`;
                a.click();
                URL.revokeObjectURL(url);
                showNotification('✅ PDF gerado e baixado!', 'success');
            }, 1000);
        }

        // 🎯 CONFIGURAÇÃO DE USUÁRIO NA PAGINA
        document.querySelectorAll('.user-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.user-option').forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // 🎯 INICIALIZAÇÃO DOS GRÁFICOS
        let networkTrafficChart, threatsChart, serversChart;

        function initializeCharts() {
            // Gráfico de Tráfego de Rede
            const trafficCtx = document.getElementById('networkTrafficChart').getContext('2d');
            networkTrafficChart = new Chart(trafficCtx, {
                type: 'line',
                data: {
                    labels: ['08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00'],
                    datasets: [{
                        label: 'Tráfego Normal',
                        data: [45, 60, 75, 80, 65, 50, 35],
                        borderColor: '#00ff88',
                        backgroundColor: 'rgba(0, 255, 136, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 2
                    }, {
                        label: 'Tráfego Suspeito',
                        data: [12, 8, 15, 25, 18, 10, 5],
                        borderColor: '#ff4444',
                        backgroundColor: 'rgba(255, 68, 68, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { color: '#ffffff', font: { size: 11 } }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { 
                                color: '#cccccc', 
                                font: { size: 10 },
                                callback: function(value) { return value + ' MB/s'; }
                            }
                        },
                        x: {
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#cccccc', font: { size: 10 } }
                        }
                    }
                }
            });

            // Gráfico de Ameaças
            const threatsCtx = document.getElementById('threatsChart').getContext('2d');
            threatsChart = new Chart(threatsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['SQL Injection', 'DDoS', 'Malware', 'Phishing', 'Port Scan'],
                    datasets: [{
                        data: [35, 25, 20, 15, 5],
                        backgroundColor: ['#ff4444', '#ffaa00', '#ff6b6b', '#4ecdc4', '#45b7d1'],
                        borderWidth: 2,
                        borderColor: '#1a1a2e'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { 
                                color: '#ffffff', 
                                font: { size: 10 },
                                padding: 8
                            }
                        }
                    },
                    cutout: '55%'
                }
            });

            // Gráfico de Servidores
            const serversCtx = document.getElementById('serversChart').getContext('2d');
            serversChart = new Chart(serversCtx, {
                type: 'bar',
                data: {
                    labels: ['Web Server', 'Database', 'API Gateway', 'Auth Service', 'File Server'],
                    datasets: [{
                        label: 'Status de Segurança (%)',
                        data: [95, 88, 92, 98, 75],
                        backgroundColor: ['#00ff88', '#00ff88', '#00ff88', '#00ff88', '#ffaa00'],
                        borderWidth: 0,
                        borderRadius: 3,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { 
                                color: '#cccccc', 
                                font: { size: 10 },
                                callback: function(value) { return value + '%'; }
                            }
                        },
                        x: {
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { 
                                color: '#cccccc', 
                                font: { size: 10 }
                            }
                        }
                    }
                }
            });
        }

        function startRealTimeUpdates() {
            setInterval(() => {
                if (networkTrafficChart && serversChart && currentUser) {
                    // Atualizar estatísticas
                    document.getElementById('attacks-blocked').textContent = 
                        (Math.floor(Math.random() * 30) + 1247).toLocaleString();
                    
                    document.getElementById('success-rate').textContent = 
                        (97.5 + Math.random() * 1.5).toFixed(1) + '%';
                    
                    document.getElementById('active-threats').textContent = 
                        Math.floor(Math.random() * 6) + 20;
                    
                    document.getElementById('response-time').textContent = 
                        (0.5 + Math.random() * 0.5).toFixed(1) + 's';

                    // Atualizar gráfico de tráfego
                    const currentTime = new Date();
                    const timeLabel = `${currentTime.getHours().toString().padStart(2, '0')}:${currentTime.getMinutes().toString().padStart(2, '0')}`;
                    
                    if (networkTrafficChart.data.labels.length > 7) {
                        networkTrafficChart.data.labels.shift();
                        networkTrafficChart.data.datasets[0].data.shift();
                        networkTrafficChart.data.datasets[1].data.shift();
                    }
                    
                    networkTrafficChart.data.labels.push(timeLabel);
                    
                    const normalTraffic = Math.max(10, 40 + Math.sin(Date.now() / 30000) * 20 + Math.random() * 15);
                    const suspiciousTraffic = Math.max(1, Math.random() * 15);
                    
                    networkTrafficChart.data.datasets[0].data.push(Math.round(normalTraffic));
                    networkTrafficChart.data.datasets[1].data.push(Math.round(suspiciousTraffic));
                    networkTrafficChart.update('quiet');

                    // Atualizar gráfico de servidores
                    serversChart.data.datasets[0].data = serversChart.data.datasets[0].data.map(
                        value => Math.min(100, Math.max(70, value + (Math.random() * 4 - 2)))
                    );
                    serversChart.update('quiet');

                    // Executar detecção ML periodicamente
                    if (Math.random() > 0.7) {
                        mlDetector.detectAnomalies();
                    }
                }
            }, 3000);
        }

        // 🎯 INICIALIZAÇÃO DO SISTEMA
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            updateOnlineStatus();
            
            // Auto-login para desenvolvimento
            setTimeout(() => {
                if (!currentUser) {
                    document.getElementById('username').value = 'admin';
                    document.getElementById('password').value = 'cyber123';
                }
            }, 100);
        });

        // 🎯 INSTALAÇÃO PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            showNotification('📱 Instale o app para melhor experiência!', 'info');
        });

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        showNotification('✅ App instalado com sucesso!', 'success');
                    }
                    deferredPrompt = null;
                });
            }
        }
    </script>
</body>
</html>
